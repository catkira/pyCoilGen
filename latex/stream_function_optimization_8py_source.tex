\hypertarget{stream_function_optimization_8py_source}{}\doxysection{stream\+Function\+Optimization.\+py}
\label{stream_function_optimization_8py_source}\index{subfunctions/streamFunctionOptimization.py@{subfunctions/streamFunctionOptimization.py}}
\mbox{\hyperlink{stream_function_optimization_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00001}\mbox{\hyperlink{namespacestream_function_optimization}{00001}} \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00002}00002 \textcolor{keyword}{import} scipy.linalg \textcolor{keyword}{as} sc}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00004}\mbox{\hyperlink{namespacestream_function_optimization_a99af08573cba0aad10350969ee5a2151}{00004}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_a99af08573cba0aad10350969ee5a2151}{streamFunctionOptimization}}(test,mesh,target,sensitivityMatrix,resistanceMatrix,tikonovFactor):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00005}00005     \textcolor{stringliteral}{'''returns the magnetic field generated by the optimized stream function. Version for only one coil part, else  a combined mesh }\textcolor{keywordflow}{is} needed\textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00006}00006 \textcolor{stringliteral}{    PotentialZeroAtBoundaryNodes = }\textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00007}00007     sensitivityMatrixSingleZKomp=np.transpose(np.array(sensitivityMatrix)[2])}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00008}00008 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00009}00009     redResMat,boundaryNodes,isNotBoundaryNode = \mbox{\hyperlink{namespacestream_function_optimization_a49be5f6b19e0d898bee34222796f54da}{reduceMatricesForBoundaryNodes}}(mesh,resistanceMatrix,PotentialZeroAtBoundaryNodes)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00010}00010     redSenMat,boundaryNodes,isNotBoundaryNode = \mbox{\hyperlink{namespacestream_function_optimization_a49be5f6b19e0d898bee34222796f54da}{reduceMatricesForBoundaryNodes}}(mesh,sensitivityMatrixSingleZKomp,PotentialZeroAtBoundaryNodes)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00011}00011  }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00012}00012     reducedSF = \mbox{\hyperlink{namespacestream_function_optimization_a4b9c3d6e9476edec03989d2a8af30d18}{applyTikonovRegularisation}}(tikonovFactor,redSenMat,redResMat, target)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00013}00013     test.reducedSF = reducedSF}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00014}00014 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00015}00015     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} PotentialZeroAtBoundaryNodes:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00016}00016         optStreamFkt = \mbox{\hyperlink{namespacestream_function_optimization_a58b519e87e2e373a76c61dac0946b313}{reexpandSteamFunctionForBoundaryNodes}}(mesh,reducedSF,boundaryNodes,isNotBoundaryNode,PotentialZeroAtBoundaryNodes)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00017}00017     \textcolor{keywordflow}{else}: optStreamFkt = reducedSF}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00019}00019     bFieldGeneratedByOptSF = [np.dot(np.transpose(sensitivityMatrix[0]),optStreamFkt), np.dot(np.transpose(sensitivityMatrix[1]),optStreamFkt), np.dot(np.transpose(sensitivityMatrix[2]),optStreamFkt)]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00021}00021     \mbox{\hyperlink{namespacestream_function_optimization_a651b9c542d7816f669d312ad183558c2}{updateMeshCurrentDensityMeshFaces}}(mesh,optStreamFkt)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00022}00022     \textcolor{keywordflow}{return} bFieldGeneratedByOptSF,optStreamFkt}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00024}\mbox{\hyperlink{namespacestream_function_optimization_a4b9c3d6e9476edec03989d2a8af30d18}{00024}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_a4b9c3d6e9476edec03989d2a8af30d18}{applyTikonovRegularisation}}(tikonovFactor,redSenMat,redResMat, target):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00025}00025     \textcolor{stringliteral}{'''returns the StreamFunction for the reduced Matrix with applied trikonov regularisation.'''}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00026}00026     tikonovFactor = tikonovFactor*np.shape(redSenMat)[0]/np.shape(redSenMat)[1]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00027}00027     tikRegMat = tikonovFactor * redResMat}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00028}00028     reducedSF = np.dot(sc.pinv(np.dot(np.transpose(np.array(redSenMat)),redSenMat) + np.dot(np.transpose(np.array(tikRegMat)),tikRegMat)),np.dot(np.transpose(np.array(redSenMat)),np.transpose(target.fieldValues[2])))}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00029}00029     \textcolor{keywordflow}{return} reducedSF}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00031}\mbox{\hyperlink{namespacestream_function_optimization_a49be5f6b19e0d898bee34222796f54da}{00031}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_a49be5f6b19e0d898bee34222796f54da}{reduceMatricesForBoundaryNodes}}(mesh, matToRed,zeroFlag):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00032}00032     \textcolor{stringliteral}{'''returns the for the boundary nodes reduced matrix'''}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00033}00033     dimToRed = \mbox{\hyperlink{namespacestream_function_optimization_af9cd68d5afc750f4a1e392b3e6c239cf}{getDimToRed}}(matToRed)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00034}00034     \textcolor{keywordflow}{if} \textcolor{keyword}{True} \textcolor{keywordflow}{in} dimToRed:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00035}00035         reducedMat = \mbox{\hyperlink{namespacestream_function_optimization_a315f60d1124593c61cf19f66ef1449bd}{getReducedMat}}(mesh,dimToRed,matToRed,zeroFlag)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00036}00036         reducedMat,boundaryNodes,notBoundaryNodes = \mbox{\hyperlink{namespacestream_function_optimization_ad8c64af54c47a22eda389c38de7b9d50}{rearrangeReducedMat}}(mesh,dimToRed,reducedMat)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00037}00037     \textcolor{keywordflow}{else}: }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00038}00038         print(\textcolor{stringliteral}{"{}nothing to reduce"{}})                }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00039}00039     \textcolor{keywordflow}{return} [reducedMat,boundaryNodes,notBoundaryNodes]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00041}\mbox{\hyperlink{namespacestream_function_optimization_ad8c64af54c47a22eda389c38de7b9d50}{00041}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_ad8c64af54c47a22eda389c38de7b9d50}{rearrangeReducedMat}}(mesh,dimToRed,reducedMat):   }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00042}00042     \textcolor{stringliteral}{'''rearranges the reduced matrix. returns: reducedMat,boundaryNodes,notBoundaryNodes'''} }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00043}00043     numNodesPerBoundary,notBoundaryNodes,boundaryNodes = \mbox{\hyperlink{namespacestream_function_optimization_a8b2eb9ed25809d0d56cdfc5bdbc19924}{getBoundaryDetails}}(mesh) }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00044}00044     boundaryNodesFirstInds = [boundaryNodes[i][0] \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(mesh.openBoundaries))]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00045}00045     \textcolor{keywordflow}{for} dimToRedInd \textcolor{keywordflow}{in} np.nonzero(dimToRed)[0]:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00046}00046         prevReducedMat = np.copy(reducedMat)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00047}00047         index1=np.array([\textcolor{stringliteral}{':'}]*np.ndim(prevReducedMat),dtype=object)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00048}00048         index2,index3,index4,index5 = np.copy(index1),np.copy(index1),np.copy(index1),np.copy(index1)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00049}00049         index1[dimToRedInd] = [i \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(mesh.openBoundaries))]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00050}00050         index2[dimToRedInd] = [x \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} boundaryNodesFirstInds]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00051}00051         index3[dimToRedInd] = np.arange((len(mesh.openBoundaries)),(len(notBoundaryNodes)+len(mesh.openBoundaries)))}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00052}00052         index4[dimToRedInd] = np.transpose(notBoundaryNodes)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00053}00053         index5[dimToRedInd] = np.arange(((len(prevReducedMat[0])-\/(sum(numNodesPerBoundary)-\/len(mesh.openBoundaries)))), len(prevReducedMat[0]))}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00055}00055         }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00056}00056         \textcolor{keywordflow}{if} index1[0] == \textcolor{stringliteral}{':'} \textcolor{keywordflow}{and} index2[0]==\textcolor{stringliteral}{':'} \textcolor{keywordflow}{and} index3[0] == \textcolor{stringliteral}{':'} \textcolor{keywordflow}{and} index4[0]==\textcolor{stringliteral}{':'} \textcolor{keywordflow}{and} index5[0] == \textcolor{stringliteral}{':'}:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00057}00057             reducedMat[:,index1[1]] = prevReducedMat[:,index2[1]]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00058}00058             reducedMat[:,index3[1]] = prevReducedMat[:,index4[1]]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00059}00059             reducedMat=np.delete(reducedMat,index5[1],1)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00060}00060         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00061}00061             reducedMat[index1[0]] = prevReducedMat[index2[0]]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00062}00062             reducedMat[index3[0]] = prevReducedMat[index4[0]]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00063}00063             reducedMat=np.delete(reducedMat,index5[0],0)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00064}00064     \textcolor{keywordflow}{return} reducedMat,boundaryNodes,notBoundaryNodes}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00066}\mbox{\hyperlink{namespacestream_function_optimization_a8b2eb9ed25809d0d56cdfc5bdbc19924}{00066}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_a8b2eb9ed25809d0d56cdfc5bdbc19924}{getBoundaryDetails}}(mesh):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00067}00067     \textcolor{stringliteral}{'''returns numNodesPerBoundary,notBoundaryNodes,boundaryNodes for the given mesh.'''}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00068}00068     numNodesPerBoundary = \mbox{\hyperlink{namespacestream_function_optimization_a77f6325fc81ed8ea215dedadab2ff946}{getNumNodesPerBoundary}}(mesh)  }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00069}00069     notBoundaryNodes = \mbox{\hyperlink{namespacestream_function_optimization_a930ef1f4f42dbad8b149cf33f78e5776}{getNotBoundaryNodes}}(mesh)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00070}00070     boundaryNodes = [mesh.openBoundaries[1],mesh.openBoundaries[0]] }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00071}00071     \textcolor{keywordflow}{return} numNodesPerBoundary,notBoundaryNodes,boundaryNodes}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00073}\mbox{\hyperlink{namespacestream_function_optimization_a315f60d1124593c61cf19f66ef1449bd}{00073}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_a315f60d1124593c61cf19f66ef1449bd}{getReducedMat}}(mesh,dimToRed,reducedMat,zeroFlag):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00074}00074     \textcolor{stringliteral}{'''returns the reduced matrix'''}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00075}00075     boundaryNodes = [mesh.openBoundaries[1],mesh.openBoundaries[0]]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00076}00076     \textcolor{keywordflow}{for} dimToRedInd \textcolor{keywordflow}{in} np.nonzero(dimToRed)[0]:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00077}00077             index1=np.array([\textcolor{stringliteral}{':'}]*np.ndim(reducedMat),dtype=object)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00078}00078             index2=np.copy(index1)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00079}00079             \textcolor{keywordflow}{for} boundaryInd \textcolor{keywordflow}{in} range(len(mesh.openBoundaries)):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00080}00080                 \textcolor{keywordflow}{if} zeroFlag:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00081}00081                     index1[dimToRedInd] = boundaryNodes[boundaryInd][0]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00082}00082                     reducedMat[index1[0:\textcolor{keywordtype}{None}]]=0}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00083}00083                 \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00084}00084                     index1[dimToRedInd] = boundaryNodes[boundaryInd][0]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00085}00085                     index2[dimToRedInd] = np.array(boundaryNodes[boundaryInd][0:\textcolor{keywordtype}{None}],dtype=int)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00086}00086                     \textcolor{keywordflow}{if} dimToRedInd:\textcolor{comment}{\#(==1)}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00087}00087                         reducedMat[:,index1[1]] = np.sum(np.array(reducedMat)[:,index2[1]],dimToRedInd)\textcolor{comment}{\#spalte ersetzen }}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00088}00088                     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00089}00089                         reducedMat[index1[0]] = np.sum(np.array(reducedMat)[index2[0]],dimToRedInd)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00090}00090     \textcolor{keywordflow}{return} reducedMat}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00092}\mbox{\hyperlink{namespacestream_function_optimization_a930ef1f4f42dbad8b149cf33f78e5776}{00092}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_a930ef1f4f42dbad8b149cf33f78e5776}{getNotBoundaryNodes}}(mesh):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00093}00093     \textcolor{stringliteral}{'''returns no-\/boundary nodes of a given mesh'''}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00094}00094     isNotBoundaryNode = []}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00095}00095     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(mesh.vertices[:,0])):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00096}00096         \textcolor{keywordflow}{if} mesh.boundary[i]:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00097}00097             \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00098}00098         \textcolor{keywordflow}{else}: isNotBoundaryNode.append(i)}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00099}00099     \textcolor{keywordflow}{return} isNotBoundaryNode}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00101}\mbox{\hyperlink{namespacestream_function_optimization_af9cd68d5afc750f4a1e392b3e6c239cf}{00101}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_af9cd68d5afc750f4a1e392b3e6c239cf}{getDimToRed}}(matToRed):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00102}00102     \textcolor{stringliteral}{'''returns boolean values which dimension should be reduced'''}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00103}00103     dimToRed=[]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00104}00104     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.shape(matToRed): }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00105}00105         \textcolor{keywordflow}{if} i == len(matToRed[0]): dimToRed.append(\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00106}00106         \textcolor{keywordflow}{else}: dimToRed.append(\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00107}00107     \textcolor{keywordflow}{return} dimToRed}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00109}\mbox{\hyperlink{namespacestream_function_optimization_a77f6325fc81ed8ea215dedadab2ff946}{00109}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_a77f6325fc81ed8ea215dedadab2ff946}{getNumNodesPerBoundary}}(mesh):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00110}00110     \textcolor{stringliteral}{'''returns the number of nodes for every boundary'''}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00111}00111     numNodesPerBoundary=[]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00112}00112     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(mesh.openBoundaries)):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00113}00113         numNodesPerBoundary.append(len(mesh.openBoundaries[i]))}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00114}00114     \textcolor{keywordflow}{return} numNodesPerBoundary}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00116}\mbox{\hyperlink{namespacestream_function_optimization_a58b519e87e2e373a76c61dac0946b313}{00116}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_a58b519e87e2e373a76c61dac0946b313}{reexpandSteamFunctionForBoundaryNodes}}(mesh,reducedSF,boundaryNodes,isNotBoundaryNode,zeroFlag):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00117}00117     \textcolor{stringliteral}{'''reexpand Streamfunction to all nodes, because the nodes of the first boundary have a potential of zero'''}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00118}00118     streamFunction = np.zeros(len(mesh.vertices))}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00119}00119     \textcolor{keywordflow}{for} boundaryInd \textcolor{keywordflow}{in} range(len(boundaryNodes)):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00120}00120         \textcolor{keywordflow}{if} zeroFlag:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00121}00121             streamFunction[boundaryNodes[boundaryInd]]=0}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00122}00122         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00123}00123             streamFunction[boundaryNodes[boundaryInd]]=reducedSF[boundaryInd]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00124}00124     }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00125}00125     streamFunction[isNotBoundaryNode]=reducedSF[len(boundaryNodes):]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00126}00126     \textcolor{keywordflow}{return} streamFunction}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00127}00127 }
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00128}\mbox{\hyperlink{namespacestream_function_optimization_a651b9c542d7816f669d312ad183558c2}{00128}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacestream_function_optimization_a651b9c542d7816f669d312ad183558c2}{updateMeshCurrentDensityMeshFaces}}(mesh,optStreamFkt):}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00129}00129     \textcolor{stringliteral}{'''updates the current density of the Faces in the mesh'''}}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00130}00130     pot1 = np.transpose(np.array([optStreamFkt[mesh.faces[:,2]]-\/optStreamFkt[mesh.faces[:,0]],optStreamFkt[mesh.faces[:,2]]-\/optStreamFkt[mesh.faces[:,0]],optStreamFkt[mesh.faces[:,2]]-\/optStreamFkt[mesh.faces[:,0]]]))}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00131}00131     pot2 = np.transpose(np.array([optStreamFkt[mesh.faces[:,1]]-\/optStreamFkt[mesh.faces[:,0]],optStreamFkt[mesh.faces[:,1]]-\/optStreamFkt[mesh.faces[:,0]],optStreamFkt[mesh.faces[:,1]]-\/optStreamFkt[mesh.faces[:,0]]]))}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00132}00132     pot3 = np.transpose(np.array([optStreamFkt[mesh.faces[:,2]]-\/optStreamFkt[mesh.faces[:,1]],optStreamFkt[mesh.faces[:,2]]-\/optStreamFkt[mesh.faces[:,1]],optStreamFkt[mesh.faces[:,2]]-\/optStreamFkt[mesh.faces[:,1]]]))}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00133}00133     edge1 = mesh.vertices[mesh.faces[:,2]]-\/mesh.vertices[mesh.faces[:,0]]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00134}00134     edge2 = mesh.vertices[mesh.faces[:,1]]-\/mesh.vertices[mesh.faces[:,0]]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00135}00135     edge3 = mesh.vertices[mesh.faces[:,2]]-\/mesh.vertices[mesh.faces[:,1]]}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00136}00136     mesh.currentDensityFaces = edge1*pot1+edge2*pot2+edge3*pot3}
\DoxyCodeLine{\Hypertarget{stream_function_optimization_8py_source_l00137}00137 }

\end{DoxyCode}
