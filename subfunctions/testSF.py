import numpy as np


from streamFunctionOptimization import reduceMatricesForBoundaryNodes

def reduceMatricesForBoundaryNodesSpecial(matToRed,meshBoundaries,meshVertices,zeroFlag):
    numNodes = len(matToRed[0])
    dimToRed=[]
    for i in np.shape(matToRed): 
        if i == numNodes: dimToRed.append(True)
        else: dimToRed.append(False)
    numBoundaries = len(meshBoundaries)
    numNodesPerBoundary=[]
    for i in range(numBoundaries):
        numNodesPerBoundary.append(len(meshBoundaries[i]))
    
    #divide between boundary or notBoundary
    isNotBoundaryNode=[]
    boundaryNodes = meshBoundaries
    for i in range(len(meshVertices[0])):
        if i in boundaryNodes[0] or i in boundaryNodes[1]:
            continue
        else: isNotBoundaryNode.append(i)
    print("no boundary", len(isNotBoundaryNode))

    #reduction CORRECT !!! :)))
    reducedMat = np.copy(matToRed)
    if True not in dimToRed:
        print("nothing to reduce")
    else: 
        for dimToRedInd in np.nonzero(dimToRed)[0]:
            index1=np.array([':']*np.ndim(matToRed),dtype=object)
            index2=np.copy(index1)
            for boundaryInd in range(numBoundaries):
                if zeroFlag:
                    index1[dimToRedInd] = boundaryNodes[boundaryInd][0]
                    reducedMat[index1[0:None]]=0
                else:
                    index1[dimToRedInd] = boundaryNodes[boundaryInd][0]
                    index2[dimToRedInd] = np.array(boundaryNodes[boundaryInd][0:None],dtype=int)
                    if index2[0] == ':' and index1[0]==':':
                        reducedMat[:,(index1[1]-1)] = np.sum(np.array(reducedMat)[:,index2[1]-1],dimToRedInd)#spalte ersetzen 
                    else:
                        print("DBR",index2[0]-1)
                        reducedMat[int(index1[0]-1)] = np.sum(np.array(reducedMat)[index2[0]-1],dimToRedInd)

        #rearange the matrix to its reduces form
        boundaryNodesFirstInds = [boundaryNodes[i][0] for i in range(numBoundaries)]
        for dimToRedInd in np.nonzero(dimToRed)[0]:
            prevReducedMat = np.copy(reducedMat)
            index1=np.array([':']*np.ndim(matToRed),dtype=object)
            index2,index3,index4,index5 = np.copy(index1),np.copy(index1),np.copy(index1),np.copy(index1)
            index1[dimToRedInd] = [i for i in range(numBoundaries)]#passt
            index2[dimToRedInd] = [x-1 for x in boundaryNodesFirstInds]#passt
            index3[dimToRedInd] = np.arange((numBoundaries),(len(isNotBoundaryNode)+numBoundaries))#passt
            new=[]
            for i in isNotBoundaryNode:
                if i == 0:
                    new.append(len(matToRed))
                else: new.append(i)
            index4[dimToRedInd] = [x-1 for x in np.sort(new)]#passt
            index5[dimToRedInd] = np.arange(((numNodes-(sum(numNodesPerBoundary)-numBoundaries))), numNodes)#passt

            
            if index1[0] == ':' and index2[0]==':' and index3[0] == ':' and index4[0]==':' and index5[0] == ':':
                reducedMat[:,index1[1]] = prevReducedMat[:,index2[1]]
                reducedMat[:,index3[1]] = prevReducedMat[:,index4[1]]
                reducedMat=np.delete(reducedMat,index5[1],1)
            else:
                reducedMat[index1[0]] = prevReducedMat[index2[0]]
                reducedMat[index3[0]] = prevReducedMat[index4[0]]
                reducedMat=np.delete(reducedMat,index5[0],0)
    print([reducedMat,boundaryNodes,isNotBoundaryNode])
    return [reducedMat,boundaryNodes,isNotBoundaryNode]

matToRed = [[0.00000000e+00, 1.74378494e-05, 0.00000000e+00, 1.12500000e-05,
  1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.12500000e-05,
  0.00000000e+00 ,0.00000000e+00],
 [1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05, 0.00000000e+00,
  1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00, 0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 1.74378494e-05,
  1.74378494e-05 ,0.00000000e+00],
 [0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,6.18784938e-06 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  1.74378494e-05 ,6.18784938e-06],
 [1.12500000e-05 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
  1.74378494e-05 ,0.00000000e+00 ,1.12500000e-05, 1.74378494e-05,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
  0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
  1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,1.74378494e-05 ,6.18784938e-06 ,0.00000000e+00,
  1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  6.18784938e-06 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.12500000e-05,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
  0.00000000e+00 ,1.12500000e-05 ,1.74378494e-05 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
  1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
  1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  1.74378494e-05 ,6.18784938e-06 ,0.00000000e+00 ,1.74378494e-05,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,6.18784938e-06,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,1.12500000e-05 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
  1.12500000e-05 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05,
  0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
  0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
  6.18784938e-06 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,6.18784938e-06 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,1.12500000e-05 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.12500000e-05,
  1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00,
  1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
  1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,6.18784938e-06,
  0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,6.18784938e-06 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  1.12500000e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  1.74378494e-05 ,0.00000000e+00 ,1.12500000e-05 ,1.74378494e-05,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
  0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
  1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,1.74378494e-05 ,6.18784938e-06 ,0.00000000e+00,
  1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  6.18784938e-06 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.12500000e-05,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
  0.00000000e+00 ,1.12500000e-05 ,1.74378494e-05 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
  1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
  1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  1.74378494e-05 ,6.18784938e-06 ,0.00000000e+00 ,1.74378494e-05,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,6.18784938e-06,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,1.12500000e-05 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
  1.12500000e-05 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05,
  0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
  0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
  6.18784938e-06 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,6.18784938e-06 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,1.12500000e-05 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.12500000e-05,
  1.74378494e-05 ,0.00000000e+00],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00,
  1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
  1.74378494e-05 ,1.74378494e-05],
 [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,6.18784938e-06,
  0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,6.18784938e-06],
 [1.12500000e-05 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  1.12500000e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  1.74378494e-05 ,0.00000000e+00],
 [0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
  0.00000000e+00 ,1.74378494e-05],
 [0.00000000e+00 ,0.00000000e+00 ,6.18784938e-06 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
  0.00000000e+00 ,1.74378494e-05 ,6.18784938e-06 ,0.00000000e+00,
  1.74378494e-05 ,0.00000000e+00]]
meshBoundaries = [[2, 5, 8, 11, 14, 17, 20, 23, 26, 29], [1, 3, 6, 9, 12, 15, 18, 21, 24, 27]]
meshVertices = [[ 3.00000000e+00,  0.00000000e+00 ,-2.50000000e+00],
 [ 3.00000000e+00,  0.00000000e+00,  0.00000000e+00],
 [ 3.00000000e+00,  0.00000000e+00,  2.50000000e+00],
 [ 2.42705098e+00,  1.76335576e+00, -2.50000000e+00],
 [ 2.42705098e+00,  1.76335576e+00,  0.00000000e+00],
 [ 2.42705098e+00,  1.76335576e+00,  2.50000000e+00],
 [ 9.27050983e-01,  2.85316955e+00, -2.50000000e+00],
 [ 9.27050983e-01,  2.85316955e+00,  0.00000000e+00],
 [ 9.27050983e-01,  2.85316955e+00,  2.50000000e+00],
 [-9.27050983e-01,  2.85316955e+00, -2.50000000e+00],
 [-9.27050983e-01,  2.85316955e+00,  0.00000000e+00],
 [-9.27050983e-01,  2.85316955e+00,  2.50000000e+00],
 [-2.42705098e+00,  1.76335576e+00, -2.50000000e+00],
 [-2.42705098e+00,  1.76335576e+00,  0.00000000e+00],
 [-2.42705098e+00,  1.76335576e+00,  2.50000000e+00],
 [-3.00000000e+00,  3.67394040e-16, -2.50000000e+00],
 [-3.00000000e+00,  3.67394040e-16,  0.00000000e+00],
 [-3.00000000e+00,  3.67394040e-16,  2.50000000e+00],
 [-2.42705098e+00, -1.76335576e+00, -2.50000000e+00],
 [-2.42705098e+00, -1.76335576e+00,  0.00000000e+00],
 [-2.42705098e+00, -1.76335576e+00,  2.50000000e+00],
 [-9.27050983e-01, -2.85316955e+00, -2.50000000e+00],
 [-9.27050983e-01, -2.85316955e+00,  0.00000000e+00],
 [-9.27050983e-01, -2.85316955e+00,  2.50000000e+00],
 [ 9.27050983e-01, -2.85316955e+00, -2.50000000e+00],
 [ 9.27050983e-01, -2.85316955e+00,  0.00000000e+00],
 [ 9.27050983e-01, -2.85316955e+00,  2.50000000e+00],
 [ 2.42705098e+00, -1.76335576e+00, -2.50000000e+00],
 [ 2.42705098e+00, -1.76335576e+00,  0.00000000e+00],
 [ 2.42705098e+00, -1.76335576e+00,  2.50000000e+00]]
meshVertices = np.transpose(meshVertices)
zeroFlag = False
[a,b,c] = reduceMatricesForBoundaryNodesSpecial(matToRed,meshBoundaries,meshVertices,zeroFlag)

def reduceMatricesForBoundaryNodesTest():
    matToRed = [[0.00000000e+00, 1.74378494e-05, 0.00000000e+00, 1.12500000e-05,
    1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.12500000e-05,
    0.00000000e+00 ,0.00000000e+00],
    [1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05, 0.00000000e+00,
    1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00, 0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 1.74378494e-05,
    1.74378494e-05 ,0.00000000e+00],
    [0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,6.18784938e-06 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    1.74378494e-05 ,6.18784938e-06],
    [1.12500000e-05 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
    1.74378494e-05 ,0.00000000e+00 ,1.12500000e-05, 1.74378494e-05,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00, 0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
    0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
    1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,1.74378494e-05 ,6.18784938e-06 ,0.00000000e+00,
    1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    6.18784938e-06 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.12500000e-05,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
    0.00000000e+00 ,1.12500000e-05 ,1.74378494e-05 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
    1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
    1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    1.74378494e-05 ,6.18784938e-06 ,0.00000000e+00 ,1.74378494e-05,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,6.18784938e-06,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,1.12500000e-05 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
    1.12500000e-05 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05,
    0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
    0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
    6.18784938e-06 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,6.18784938e-06 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,1.12500000e-05 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.12500000e-05,
    1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00,
    1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
    1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,6.18784938e-06,
    0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,6.18784938e-06 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    1.12500000e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    1.74378494e-05 ,0.00000000e+00 ,1.12500000e-05 ,1.74378494e-05,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
    0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
    1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,1.74378494e-05 ,6.18784938e-06 ,0.00000000e+00,
    1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    6.18784938e-06 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.12500000e-05,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
    0.00000000e+00 ,1.12500000e-05 ,1.74378494e-05 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
    1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
    1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    1.74378494e-05 ,6.18784938e-06 ,0.00000000e+00 ,1.74378494e-05,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,6.18784938e-06,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,1.12500000e-05 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
    1.12500000e-05 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05,
    0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
    0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05,
    6.18784938e-06 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,6.18784938e-06 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,1.12500000e-05 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,1.12500000e-05,
    1.74378494e-05 ,0.00000000e+00],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00,
    1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00,
    1.74378494e-05 ,1.74378494e-05],
    [0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,1.74378494e-05 ,6.18784938e-06,
    0.00000000e+00 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,6.18784938e-06],
    [1.12500000e-05 ,1.74378494e-05 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    1.12500000e-05 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    1.74378494e-05 ,0.00000000e+00],
    [0.00000000e+00 ,1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    1.74378494e-05 ,1.74378494e-05 ,0.00000000e+00 ,1.74378494e-05,
    0.00000000e+00 ,1.74378494e-05],
    [0.00000000e+00 ,0.00000000e+00 ,6.18784938e-06 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00 ,0.00000000e+00,
    0.00000000e+00 ,1.74378494e-05 ,6.18784938e-06 ,0.00000000e+00,
    1.74378494e-05 ,0.00000000e+00]]
    meshBoundaries = [[2, 5, 8, 11, 14, 17, 20, 23, 26, 29], [1, 3, 6, 9, 12, 15, 18, 21, 24, 27]]
    meshVertices = [[ 3.00000000e+00,  0.00000000e+00 ,-2.50000000e+00],
    [ 3.00000000e+00,  0.00000000e+00,  0.00000000e+00],
    [ 3.00000000e+00,  0.00000000e+00,  2.50000000e+00],
    [ 2.42705098e+00,  1.76335576e+00, -2.50000000e+00],
    [ 2.42705098e+00,  1.76335576e+00,  0.00000000e+00],
    [ 2.42705098e+00,  1.76335576e+00,  2.50000000e+00],
    [ 9.27050983e-01,  2.85316955e+00, -2.50000000e+00],
    [ 9.27050983e-01,  2.85316955e+00,  0.00000000e+00],
    [ 9.27050983e-01,  2.85316955e+00,  2.50000000e+00],
    [-9.27050983e-01,  2.85316955e+00, -2.50000000e+00],
    [-9.27050983e-01,  2.85316955e+00,  0.00000000e+00],
    [-9.27050983e-01,  2.85316955e+00,  2.50000000e+00],
    [-2.42705098e+00,  1.76335576e+00, -2.50000000e+00],
    [-2.42705098e+00,  1.76335576e+00,  0.00000000e+00],
    [-2.42705098e+00,  1.76335576e+00,  2.50000000e+00],
    [-3.00000000e+00,  3.67394040e-16, -2.50000000e+00],
    [-3.00000000e+00,  3.67394040e-16,  0.00000000e+00],
    [-3.00000000e+00,  3.67394040e-16,  2.50000000e+00],
    [-2.42705098e+00, -1.76335576e+00, -2.50000000e+00],
    [-2.42705098e+00, -1.76335576e+00,  0.00000000e+00],
    [-2.42705098e+00, -1.76335576e+00,  2.50000000e+00],
    [-9.27050983e-01, -2.85316955e+00, -2.50000000e+00],
    [-9.27050983e-01, -2.85316955e+00,  0.00000000e+00],
    [-9.27050983e-01, -2.85316955e+00,  2.50000000e+00],
    [ 9.27050983e-01, -2.85316955e+00, -2.50000000e+00],
    [ 9.27050983e-01, -2.85316955e+00,  0.00000000e+00],
    [ 9.27050983e-01, -2.85316955e+00,  2.50000000e+00],
    [ 2.42705098e+00, -1.76335576e+00, -2.50000000e+00],
    [ 2.42705098e+00, -1.76335576e+00,  0.00000000e+00],
    [ 2.42705098e+00, -1.76335576e+00,  2.50000000e+00]]
    meshVertices = np.transpose(meshVertices)
    zeroFlag = False
    return reduceMatricesForBoundaryNodesSpecial(matToRed,meshVertices,meshBoundaries,zeroFlag) == [[[3.48756988e-04, 3.48756988e-04, 3.48756988e-05, 3.48756988e-05,
        3.48756988e-05, 3.48756988e-05, 3.48756988e-05, 3.48756988e-05,
        3.48756988e-05, 3.48756988e-05, 3.48756988e-05, 3.48756988e-05],
       [3.48756988e-04, 9.90055901e-05, 1.12500000e-05, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 1.12500000e-05, 1.23756988e-05],
       [3.48756988e-05, 1.12500000e-05, 0.00000000e+00, 1.12500000e-05,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
       [3.48756988e-05, 0.00000000e+00, 1.12500000e-05, 0.00000000e+00,
        1.12500000e-05, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
       [3.48756988e-05, 0.00000000e+00, 0.00000000e+00, 1.12500000e-05,
        0.00000000e+00, 1.12500000e-05, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
       [3.48756988e-05, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        1.12500000e-05, 0.00000000e+00, 1.12500000e-05, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
       [3.48756988e-05, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 1.12500000e-05, 0.00000000e+00, 1.12500000e-05,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
       [3.48756988e-05, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 1.12500000e-05, 0.00000000e+00,
        1.12500000e-05, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
       [3.48756988e-05, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 1.12500000e-05,
        0.00000000e+00, 1.12500000e-05, 0.00000000e+00, 0.00000000e+00],
       [3.48756988e-05, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        1.12500000e-05, 0.00000000e+00, 1.12500000e-05, 0.00000000e+00],
       [3.48756988e-05, 1.12500000e-05, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 1.12500000e-05, 0.00000000e+00, 0.00000000e+00],
       [3.48756988e-05, 1.23756988e-05, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
        0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]], [[2, 5, 8, 11, 14, 17, 20, 23, 26, 29], [1, 3, 6, 9, 12, 15, 18, 21, 24, 27]], [0, 4, 7, 10, 13, 16, 19, 22, 25, 28]]
print(reduceMatricesForBoundaryNodesTest(matToRed,meshVertices,meshBoundaries,zeroFlag))